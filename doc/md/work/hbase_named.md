## Hbase rowkey设计
### rowkey特点
- RowKey类似于主键，可以唯一的标识一行记录。Hbase中使用rowkey查询速度很快
- 由于数据按照RowKey的字典序(byte order)排序存储，HBase中的数据都是有序的
- RowKey可以由自己指定
********
### 设计经验
- **需求：用户个人相关数据表**

```
首先在rowkey设计上第一点考虑用户个人ID是否满足Hbase rowkey原则，由于项目上 获得的userID是一串MD5码
1.唯一性有保证
2.零散分布，不存在某区间热点问题
所以在设计用户Hbase表的时候直接复用了项目中的userID
```

- **需求：数据统计需求，根据每个日期统计出相关指标数据**

```
在对于可能有Group By问题的时候，在统计的过程中通常会使用到Hbase协处理器。一般来说协处理器在同一台机器上合并处理少量数据情况是最好的状态。
工作中项目应用的一天的数据按照各种维度排列下来大概在4000条左右。此时rowkey的设计更加保守一点
1. rowkey开头使用日期字段：如 20200101 -> 01|XXXX  20200102 -> 02|XXXX
2. 预分区的方式：将每个rowkey预分区到不同的分区里去，因为前端Group By查询是天为单位。
   所以在一个时间区间内，不同的天在不同的分区中处理，并且相关的group By 操作在同一个分区里面，没有任何网络数据传输请求
create 'TABLE_NAME',{NAME=>'B',VERSIONS=>1}, SPLITS => ['02|','03|','04|','05|','06|','07|','08|','09|','10|','11|','12|','13|','14|','15|','16|','17|','18|','19|','20|','21|','22|','23|','24|','25|','26|','27|','28|','29|','30|']
```
- **需求:同一用户有多条数据**

```
每个用户可能每天都存在一条数据保存用户的当天状态值，但是在需求方可能又要求统计用户在一段时间内相关指标。
1.rowkey设计以用户为主要点，对用户的ID进行Hash取值，并且添加当天的日期到rowkey中
2. 预分区的方式，采用预分区的方式避免Hbase自动分区发生
```